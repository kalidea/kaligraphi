<div class="kal-autocomplete-virtual-scroll-viewport"
     [style.width]="width"
     [ngClass]="getClasses()">

  <div *ngIf="loading; else displayOptionsTemplate"
       [style.height]="height"
       [kalLoading]="loading">
  </div>

  <ng-template #displayOptionsTemplate>

    <cdk-virtual-scroll-viewport
      class="kal-autocomplete-scroll-viewport"
      [itemSize]="virtualScrollConfig.itemSize"
      [style.height]="height">

    <ng-container *cdkVirtualFor="let option of options; index as i">

        <kal-option (click)="select(option)"
                    (selectionChange)="select(option)"
                    [disabled]="option.disabled"
                    [label]="option.label"
                    [value]="option">

          <ng-container
            *ngTemplateOutlet="data.optionTemplate ? data.optionTemplate : noTemplate; context: {index: i, option: option}"></ng-container>

          <ng-template #noTemplate>{{ option.label }}</ng-template>

        </kal-option>

      </ng-container>

    </cdk-virtual-scroll-viewport>

  </ng-template>

</div>
